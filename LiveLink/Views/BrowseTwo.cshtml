@using LiveLink.App_Code
@using Newtonsoft.Json
@inherits Our.Umbraco.Ditto.DittoView<LiveLink.Services.Models.ViewModels.BrowseViewModel>
@{
    Layout = "Master.cshtml";
}
    
<div class="browse__container">
    <div class="row no-gutters full-height">
        <div class="col-sm-8 col-md-8 full-height">
            
            <div class="row no-gutters">
                <div class="col-md-12">
                    <div class="mapcontrols">
                        <!-- Form Controls -->
                        <form class="js-map-controls" action="#">
                            <input type="text" name="EarliestDate" value="01/01/2017">
                            <input type="text" name="LatestDate" value="01/01/2018">
                        </form>
                    </div>
                    
                </div>
            </div>

            <!-- Map -->
            <div class="map"></div>

        </div>
        <div class="col-sm-4 col-md-4 full-height">
            <div class="listing__container">
                <!-- Page Header -->
                <div class="row no-gutters">
                    <div class="col-lg-12">
                        <h1 class="page-header">
                            Browse
                            <small>lots of events</small>
                        </h1>
                    </div>
                </div>
                <!-- /.row -->
                <!-- Projects Row -->

                
                    @foreach (var e in Model.View.Venues.SelectMany(x => x.Events))
                    {
                        <div class="row no-gutters">
                            <div class="col-md-12 ">
                                <div class="listing">
                                    <a href="@e.Url">
                                        <img class="img-responsive" src="@(!string.IsNullOrEmpty(e.ThumbnailUrl) ? e.ThumbnailUrl : "/images/bg.jpg")?width=1050&height=500&mode=crop" alt="">
                                    </a>
                                    <div class="listing__content">
                                        <h3>
                                            <a href="@e.Url">@e.Title</a>
                                        </h3>
                                        <p><b>@e.StartTime.ToLongDateString()</b> - @e.SummaryShort</p>
                                    </div>
                                    
                                </div>
                            </div>
                        </div>
                    }
                

                <!-- /.row -->
            </div>
           
        </div>

    </div>

</div>
    

@section JSPlugins
{
    <script type="application/json" id="events-json">
        @Html.Raw(JsonConvert.SerializeObject(Model.View.Venues))
    </script>

    <script type="text/mustache" id="infoWindowTemplate">
        @Html.RenderRawContent("~/Views/Partials/InfoWindow.mustache")
    </script>
}